!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("GPX",[],t):"object"==typeof exports?exports.GPX=t():e.GPX=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";function n(e){return null!=e&&"object"==typeof e&&!0===e["@@functional/placeholder"]}function o(e){return function t(r){return 0===arguments.length||n(r)?t:e.apply(this,arguments)}}r.r(t),r.d(t,"initAttribute",(function(){return ee})),r.d(t,"configureAttribute",(function(){return te})),r.d(t,"initUniform",(function(){return re})),r.d(t,"updateUniform",(function(){return ne})),r.d(t,"setViewPort",(function(){return oe})),r.d(t,"logState",(function(){return ie})),r.d(t,"createBuffer",(function(){return ue})),r.d(t,"bindBuffer",(function(){return fe})),r.d(t,"setBufferData",(function(){return ce})),r.d(t,"buffer",(function(){return ae})),r.d(t,"drawArrays",(function(){return se})),r.d(t,"drawArraysInstanced",(function(){return le})),r.d(t,"createProgramAndCompileShaders",(function(){return pe})),r.d(t,"fetchContext",(function(){return ve})),r.d(t,"useProgram",(function(){return he})),r.d(t,"createVao",(function(){return ye})),r.d(t,"bindVao",(function(){return ge}));var i=Array.isArray||function(e){return null!=e&&e.length>=0&&"[object Array]"===Object.prototype.toString.call(e)};var u=o((function(e){return!!i(e)||!!e&&("object"==typeof e&&(!function(e){return"[object String]"===Object.prototype.toString.call(e)}(e)&&(1===e.nodeType?!!e.length:0===e.length||e.length>0&&(e.hasOwnProperty(0)&&e.hasOwnProperty(e.length-1)))))}));function f(e){return function t(r){for(var n,o,i,f=[],c=0,a=r.length;c<a;){if(u(r[c]))for(i=0,o=(n=e?t(r[c]):r[c]).length;i<o;)f[f.length]=n[i],i+=1;else f[f.length]=r[c];c+=1}return f}}var c=o(f(!0));function a(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.join(","):"")+". Find the full error at: https://bit.ly/38PiBHb")}function s(e){return!!e&&!!e[K]}function l(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[W]||!!e.constructor[W]||g(e)||b(e))}function d(e,t){0===p(e)?X(e).forEach((function(r){return t(r,e[r],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function p(e){var t=e[K];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:g(e)?2:b(e)?3:0}function v(e,t){return 2===p(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function h(e,t){return 2===p(e)?e.get(t):e[t]}function y(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function g(e){return $&&e instanceof Map}function b(e){return B&&e instanceof Set}function m(e){return e.o||e.t}function P(e,t){if(void 0===t&&(t=!1),Array.isArray(e))return e.slice();var r=Object.create(Object.getPrototypeOf(e));return d(e,(function(n){if(n!==K){var o=Object.getOwnPropertyDescriptor(e,n),i=o.value;o.get&&(t||a(1),i=o.get.call(e)),o.enumerable?r[n]=i:Object.defineProperty(r,n,{value:i,writable:!0,configurable:!0})}})),r}function A(e,t){s(e)||Object.isFrozen(e)||!l(e)||(p(e)>1&&(e.set=e.add=e.clear=e.delete=O),Object.freeze(e),t&&d(e,(function(e,t){return A(t,!0)})))}function O(){a(2)}function S(e){var t=H[e];return t||a(19,e),t}function w(){return U}function j(e,t){t&&(S("Patches"),e.u=[],e.s=[],e.v=t)}function x(e){E(e),e.p.forEach(D),e.p=null}function E(e){e===U&&(U=e.l)}function _(e){return U={p:[],l:U,h:e,m:!0,_:0}}function D(e){var t=e[K];0===t.i||1===t.i?t.j():t.O=!0}function F(e,t){t._=t.p.length;var r=t.p[0],n=void 0!==e&&e!==r;return t.h.g||S("ES5").P(t,e,n),n?(r[K].S&&(x(t),a(4)),l(e)&&(e=I(t,e),t.l||z(t,e)),t.u&&S("Patches").M(r[K],e,t.u,t.s)):e=I(t,r,[]),x(t),t.u&&t.v(t.u,t.s),e!==G?e:void 0}function I(e,t,r){if(Object.isFrozen(t))return t;var n=t[K];if(!n)return d(t,(function(o,i){return R(e,n,t,o,i,r)})),t;if(n.A!==e)return t;if(!n.S)return z(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var o=4===n.i||5===n.i?n.o=P(n.k,!0):n.o;d(o,(function(t,i){return R(e,n,o,t,i,r)})),z(e,o,!1),r&&e.u&&S("Patches").R(n,r,e.u,e.s)}return n.o}function R(e,t,r,n,o,i){if(s(o)){var u=I(e,o,i&&t&&3!==t.i&&!v(t.D,n)?i.concat(n):void 0);if(c=n,a=u,2===(d=p(f=r))?f.set(c,a):3===d?(f.delete(c),f.add(a)):f[c]=a,!s(u))return;e.m=!1}var f,c,a,d;if((!t||!y(o,h(t.t,n)))&&l(o)){if(!e.h.N&&e._<1)return;I(e,o),t&&t.A.l||z(e,o)}}function z(e,t,r){void 0===r&&(r=!1),e.h.N&&e.m&&A(t,r)}function T(e,t){var r=e[K],n=Reflect.getOwnPropertyDescriptor(r?m(r):e,t);return n&&n.value}function k(e){if(!e.S){if(e.S=!0,0===e.i||1===e.i){var t=e.o=P(e.t);d(e.p,(function(e,r){t[e]=r})),e.p=void 0}e.l&&k(e.l)}}function C(e){e.o||(e.o=P(e.t))}function M(e,t,r){var n=g(t)?S("MapSet").T(t,r):b(t)?S("MapSet").F(t,r):e.g?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:w(),S:!1,I:!1,D:{},l:t,t:e,k:null,p:{},o:null,j:null,C:!1},o=n,i=J;r&&(o=[n],i=Y);var u=Proxy.revocable(o,i),f=u.revoke,c=u.proxy;return n.k=c,n.j=f,c}(t,r):S("ES5").J(t,r);return(r?r.A:w()).p.push(n),n}var N,U,L="undefined"!=typeof Symbol,$="undefined"!=typeof Map,B="undefined"!=typeof Set,V="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,G=L?Symbol("immer-nothing"):((N={})["immer-nothing"]=!0,N),W=L?Symbol("immer-draftable"):"__$immer_draftable",K=L?Symbol("immer-state"):"__$immer_state",X=(L&&Symbol.iterator,"undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames),H={},J={get:function(e,t){if(t===K)return e;var r=e.p;if(!e.S&&v(r,t))return r[t];var n=m(e)[t];if(e.I||!l(n))return n;if(e.S){if(n!==T(e.t,t))return n;r=e.o}return r[t]=M(e.A.h,n,e)},has:function(e,t){return t in m(e)},ownKeys:function(e){return Reflect.ownKeys(m(e))},set:function(e,t,r){if(!e.S){var n=T(e.t,t);if(r?y(n,r)||r===e.p[t]:y(n,r)&&t in e.t)return!0;C(e),k(e)}return e.D[t]=!0,e.o[t]=r,!0},deleteProperty:function(e,t){return void 0!==T(e.t,t)||t in e.t?(e.D[t]=!1,C(e),k(e)):e.D[t]&&delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=m(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&(n.writable=!0,n.configurable=1!==e.i||"length"!==t),n},defineProperty:function(){a(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){a(12)}},Y={};d(J,(function(e,t){Y[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Y.deleteProperty=function(e,t){return J.deleteProperty.call(this,e[0],t)},Y.set=function(e,t,r){return J.set.call(this,e[0],t,r,e[0])};var q=new(function(){function e(e){this.g=V,this.N=!1,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,t,r){if("function"==typeof e&&"function"!=typeof t){var n=t;t=e;var o=this;return function(e){var r=this;void 0===e&&(e=n);for(var i=arguments.length,u=Array(i>1?i-1:0),f=1;f<i;f++)u[f-1]=arguments[f];return o.produce(e,(function(e){var n;return(n=t).call.apply(n,[r,e].concat(u))}))}}var i;if("function"!=typeof t&&a(6),void 0!==r&&"function"!=typeof r&&a(7),l(e)){var u=_(this),f=M(this,e,void 0),c=!0;try{i=t(f),c=!1}finally{c?x(u):E(u)}return"undefined"!=typeof Promise&&i instanceof Promise?i.then((function(e){return j(u,r),F(e,u)}),(function(e){throw x(u),e})):(j(u,r),F(i,u))}if((i=t(e))!==G)return void 0===i&&(i=e),this.N&&A(i,!0),i},t.produceWithPatches=function(e,t){var r,n,o=this;return"function"==typeof e?function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return o.produceWithPatches(t,(function(t){return e.apply(void 0,[t].concat(n))}))}:[this.produce(e,t,(function(e,t){r=e,n=t})),r,n]},t.createDraft=function(e){l(e)||a(8);var t=_(this),r=M(this,e,void 0);return r[K].C=!0,E(t),r},t.finishDraft=function(e,t){var r=(e&&e[K]).A;return j(r,t),F(void 0,r)},t.setAutoFreeze=function(e){this.N=e},t.setUseProxies=function(e){V||a(20),this.g=e},t.applyPatches=function(e,t){var r;for(r=t.length-1;r>=0;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}var o=S("Patches").H;return s(e)?o(e,t):this.produce(e,(function(e){return o(e,t.slice(r+1))}))},e}()),Q=q.produce;q.produceWithPatches.bind(q),q.setAutoFreeze.bind(q),q.setUseProxies.bind(q),q.applyPatches.bind(q),q.createDraft.bind(q),q.finishDraft.bind(q);const Z=e=>t=>Q(t,t=>e(t)),ee=(e,t)=>({resolve:Z(r=>{const{gl:n,program:o,attributes:i}=r,u=n.getAttribLocation(o,e);if(-1===u)throw new Error(`getAttribLocation returned -1 from attribute ${e}.`);i[e]={location:u,size:t.size,type:t.type||n.FLOAT,offset:t.offset||0,stride:t.stride||0,normalized:t.normalized||!1,divisor:t.divisor}})}),te=e=>({resolve:Z(t=>{const{gl:r,attributes:n}=t,o=n[e];r.enableVertexAttribArray(o.location),r.vertexAttribPointer(o.location,o.size,o.type,o.normalized,o.stride,o.offset),null!==o.divisor&&void 0!==o.divisor&&r.vertexAttribDivisor(o.location,o.divisor)})}),re=e=>({resolve:Z(t=>{const{gl:r,program:n}=t,o=r.getUniformLocation(n,e);console.log(o),null===o&&console.error(`Uniform location not found: ${e}`),t.uniforms[e]={location:o}})}),ne=(e,{type:t,data:r,offset:n,length:o})=>({resolve:Z(o=>{const{gl:i,uniforms:u}=o,f=u[e].location;switch(t){case"uniform1ui":case"uniform1f":i[t](f,r[0]);break;case"uniform2ui":i.uniform2ui(f,r[0],r[1]);break;case"uniform3ui":i.uniform3ui(f,r[0],r[1],r[2]);break;case"uniform4ui":i.uniform4ui(f,r[0],r[1],r[2],r[3]);break;case"uniform1fv":case"uniform2fv":case"uniform3fv":case"uniform4fv":case"uniform1iv":case"uniform2iv":case"uniform3iv":case"uniform4iv":case"uniform1uiv":case"uniform2uiv":case"uniform3uiv":case"uniform4uiv":i[t](f,r,n);break;default:throw new Error(`Invalid uniform update type passed: ${t}`)}})}),oe=(e={})=>({resolve:Z(t=>{const{gl:r}=t;r.viewport(e.x||0,e.y||0,e.width||r.canvas.width,e.height||r.canvas.height)})}),ie=e=>({resolve:Z(t=>{console.log(e),console.log(function(e){if(e&&e[K])return e[K].t}(t))})}),ue=(e,t)=>({resolve:Z(r=>{const{gl:n}=r,o=n.createBuffer();r.buffers[e]={handle:o,target:n.ARRAY_BUFFER,usage:n.STATIC_DRAW,...t}})}),fe=e=>({resolve:Z(t=>{const{gl:r,buffers:n}=t;if(!n[e])throw new Error(`Buffer of name ${e} does has not been created`);const o=n[e];r.bindBuffer(o.target,o.handle)})}),ce=(e,t)=>({resolve:Z(r=>{const{gl:n,buffers:o}=r,i=o[e];n.bufferData(i.target,t,i.usage)})}),ae=(e,t,r)=>Pe.Compose(ue(e,r),fe(e),ce(e,t))(),se=(e={})=>({resolve:Z(t=>{const{gl:r}=t;r.drawArrays(e.type||r.POINTS,e.first||0,e.count)})}),le=e=>({resolve:Z(t=>{const{gl:r}=t;r.drawArraysInstanced(e.mode||r.TRIANGLES,e.first||0,e.count,e.instanceCount)})}),de=(e,t,r)=>{const n=e.createShader(t);if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw console.error("error occured during compiling shader:"),console.error(e.getShaderInfoLog(n)),r&&r.split("\n").forEach((e,t)=>{console.error(`${t}: ${e}`)}),e.deleteShader(n),new Error("Shader compilation failed.");return n},pe=({vs:e,fs:t})=>({opts:{},resolve:Z(r=>{const{gl:n}=r,o=((e,t,r)=>{const n=de(e,e.VERTEX_SHADER,t),o=de(e,e.FRAGMENT_SHADER,r),i=e.createProgram();if(e.attachShader(i,n),e.attachShader(i,o),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS))throw new Error("Unable to initialize the shader program: "+e.getProgramInfoLog(i));return i})(n,e,t);r.program=o})}),ve=e=>({opts:{},resolve:Z(t=>{const r=(e=>{const t={};let r=0;return Object.keys(e).forEach(r=>{t[r]=e[r]}),Object.keys(Object.getPrototypeOf(e)).forEach(n=>{e[n]instanceof Function?t[n]=(...t)=>(r+=1,console.log(`Calling gl.${n}`),e[n](...t)):t[n]=e[n]}),t.getInstrumenter=()=>({callCount:()=>r,log:()=>{},reset:()=>{r=0}}),t})(e.getContext("webgl2"));t.gl=r})}),he=()=>({resolve:Z(e=>{const{gl:t,program:r}=e;t.useProgram(r)})}),ye=()=>({resolve:Z(e=>{const{gl:t}=e;e.vao=t.createVertexArray()})}),ge=()=>({resolve:Z(e=>{const{gl:t,vao:r}=e;t.bindVertexArray(r)})}),be=(e,...t)=>{for(let r=0;r<t.length;r++){e=t[r].resolve(e)}return Object.freeze(e)},me=(...e)=>be({attributes:{},buffers:{},uniforms:{},textures:{},framebuffers:{}},...c(e));me.Compose=(...e)=>()=>({resolve:t=>be(t,...e)}),me.pipeFirst=(e,...t)=>t.map(t=>{if(t instanceof Function)return t(e);if(t instanceof Array){if(!(t[0]instanceof Function))throw new Error("Invalid arguments passed to GPX.pipeFirst");return t[0](e,...t.slice(1))}throw new Error("invalid args passed to pipeFirst")});var Pe=t.default=me}])}));